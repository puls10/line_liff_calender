<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LINE Calendar</title>

  <!-- LIFF SDK -->
  <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>

  <!-- FullCalendar CDN -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
      padding: 1rem;
      margin: 0;
      background-color: #f7f7f7;
    }

    h1, h2 {
      text-align: center;
      font-size: 1.5rem;
      margin-top: 1rem;
    }

    #user {
      text-align: center;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }

    #calendar {
      max-width: 100%;
      margin: 0 auto;
    }

    #schedule-list {
      max-width: 90%;
      margin: 1rem auto;
      padding: 0;
      list-style: none;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 0 6px rgba(0,0,0,0.1);
    }

    #schedule-list li {
      padding: 0.75rem 1rem;
      border-bottom: 1px solid #eee;
    }

    @media (max-width: 600px) {
      h1, h2 {
        font-size: 1.2rem;
      }

      #schedule-list li {
        font-size: 0.9rem;
        padding: 0.5rem 0.75rem;
      }
    }
  </style>
</head>
<body>
  <h1>カレンダー予定追加</h1>
  <div id="user"></div>
  <div id="calendar"></div>

  <h2>予定一覧</h2>
  <ul id="schedule-list"></ul>

  <script>
    const scheduleList = [];

    async function init() {
      await liff.init({ liffId: "2007134594-R5KEBJjL" });

      if (!liff.isLoggedIn()) {
        liff.login();
      } else {
        const profile = await liff.getProfile();
        document.getElementById("user").innerText = `こんにちは、${profile.displayName}さん！`;
        initCalendar();
      }
    }

    function initCalendar() {
      const calendarEl = document.getElementById('calendar');
      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        selectable: true,
        aspectRatio: 1,
        headerToolbar: {
          left: 'prev,next today',
          center: 'title',
          right: ''
        },
        dateClick: function(info) {
          const title = prompt(`${info.dateStr} の予定を入力してください:`);
          if (title) {
            calendar.addEvent({
              title: title,
              start: info.dateStr
            });
            scheduleList.push({ date: info.dateStr, event: title });
            renderList();
          }
        }
      });
      calendar.render();
    }

    function renderList() {
      const ul = document.getElementById("schedule-list");
      ul.innerHTML = "";
      scheduleList.forEach(item => {
        const li = document.createElement("li");
        li.innerText = `${item.date} - ${item.event}`;
        ul.appendChild(li);
      });
    }

    init();
  </script>
</body>
</html>

